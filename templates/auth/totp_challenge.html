<!-- templates/auth/totp_challenge.html -->
{% extends "base.html" %}
{% block content %}
  <div class="page-header">
    <h1>Two-Factor Authentication</h1>
    <p class="text-muted" style="margin:0;">Enter the 6-digit code from your authenticator app.</p>
  </div>

  <div class="card-elevated">
    <div class="card-header-accent">
      <h2>Authenticator Challenge</h2>
    </div>
    <div class="org-card-body">
      <form method="post" action="{{ url_for('auth.twofa_verify_login') }}" style="display:grid; gap:1rem; max-width:360px;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
          <label for="token">Code</label>
          <input id="token" name="token" class="input" inputmode="numeric" pattern="\d{6}" maxlength="6" required>
        </div>
        <button class="btn btn-primary" type="submit">Verify</button>
      </form>
    </div>
  </div>
{% endblock %}
